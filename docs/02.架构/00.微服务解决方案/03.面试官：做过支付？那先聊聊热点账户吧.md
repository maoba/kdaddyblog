---
title: 面试官：做过支付？那先聊聊热点账户吧
date: 2023-12-26 22:21:14
permalink: /pages/54677a/
categories:
  - 架构
  - 微服务解决方案
tags:
  - 面经
  - 热点账户
author: 
  name: 老猫
  link: https://github.com/maoba
---
### 背景
当前形势不佳，在这种情况下。小猫更是雪上加霜，他被裁了。投了个把月简历，终于约到一个面试。
面试官翻了一下简历：“看你简历上写了支付和账户相关项目，那能否聊一下热点账户问题你们是咋处理的吧”。

小猫懵逼了一会，“额？什么是热点账户？我们好像模型里面就一个资产账户，然后充值的时候和消费的时候更新一下该账户，并且记录一下操作明细，然后结束了。”

面试官：“哦。回去等通知吧。”

出来之后，小猫整个人都还是懵逼的。

### 问题分析
我们一起来看一下这样一个问题，其实这里面面试官想要知道的是，在高并发的情况下，针对热点账户如何进行账户金额的扣减动作，小猫没有get到面试的点，第一个可能他负责的项目中本身的量不大，压根就没有想过这类问题。

接下来，咱们一起从以下几点来剖析一下这个问题吧。


### 什么是热点账户？
热点账户一般指被高频更新的账户，比如短时间内大量的账户余额更新请求集中在极少数账户上。这类账户虽然数量不多，但更新频率很高，处理不当可能会带来严重的性能问题，影响其他账户的正常读写操作。

我们来看一下当大量请求并发打到我们数据库底层表的时候，都发生了什么。假设我们现在有用户A、用户B、用户C，等等可能更多，另外有一个商家账户S，我们暂时枚举三个，那么当其同时并发打到底层数据库的时候，就有如下图所示。

![数据库底层更新](https://cdn.ktdaddy.com/architecture/biz/hotacc/base.png?imageView2/0/q/75|imageslim)


